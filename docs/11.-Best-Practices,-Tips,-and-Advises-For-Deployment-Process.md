- [1. Use Secrets and Environment-Specific Parameters](#1-use-secrets-and-environment-specific-parameters)
- [2. Working with Multi-DDL-Statatements Changesets](#2-working-with-multi-ddl-statatements-changesets)
- [3. Delete APEX App in SRC Before Export](#3-delete-apex-app-in-src-before-export)
- [4. Re-Enabling Automations and REST Syncs After the Install](#4-re-enabling-automations-and-rest-syncs-after-the-install)
- [5. Getting Rid of Fake ORDS Changes](#5-getting-rid-of-fake-ords-changes)
- [6. Artifact Deployment Fails with Java Error when the Artifact Generates No Changes](#6-artifact-deployment-fails-with-java-error-when-the-artifact-generates-no-changes)
- [7. Run LB Status before Prod Deployment To Avoid Surprises](#7-run-lb-status-before-prod-deployment-to-avoid-surprises)
- [8. APEX Apps Manual Backup](#8-apex-apps-manual-backup)


## 1. Use Secrets and Environment-Specific Parameters

## 2. Working with Multi-DDL-Statatements Changesets

## 3. Delete APEX App in SRC Before Export

## 4. Re-Enabling Automations and REST Syncs After the Install

If you added in your feature a new active scheduled Automation or REST Sync, make sure you added a reference to it into `dist/utils/enable_automations.sql` file.

APEX 24.2.has a very annoying bug that all scheduled automations and REST sycns become disabled after the import.

## 5. Getting Rid of Fake ORDS Changes

As another very annoying bug in SQLcl Project ORDS changes are generated even when there are no changes to ORDS metadata. It may create unnecessary merge conflicts and confusion.

To rectify that after `project stage` command run the following ( unless your fetaure indeed has changes to ORDS and you want to import entire ORDS schema)

<div class="code panel pdl conf-macro output-block" hasbody="true" local-id="29f0d422-07a4-4044-bcc8-16fec337f068" macro-id="c9c9e808-e831-421e-82aa-17066fe12dd4" macro-name="code" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` sql
git restore --source=main --worktree --staged -- dist/releases/ords
```

</div>

</div>

## 6. Artifact Deployment Fails with Java Error when the Artifact Generates No Changes

Looks like sometimes the atricact for whatever reason cannot create a log and fails with an error like on below.

It can be safely ignored

<div class="code panel pdl conf-macro output-block" hasbody="true" local-id="a005a698-429f-4839-a9a7-9f7443a3f986" macro-id="d188f086-4aef-461b-8b7a-da2dfb2f4191" macro-name="code" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` sql
tarting the migration...
Installing/updating schemas
--Starting Liquibase at 2025-11-21T16:06:36.141710600 using Java 17.0.13 (version 4.30.0 #0 built at 2025-04-01 10:24+0000)
Running Changeset: dev-01/_custom/ams_config_dml.sql::1761249915279::SqlCl

UPDATE SUMMARY
Run:                          1
Previously run:            2572
Filtered out:                 0
-------------------------------
Total change sets:         2573

Liquibase: Update has been successful. Rows affected: 0

Null Pointer please log a bug.
java.lang.NullPointerException: Cannot invoke "java.io.File.getName()" because the return value of "oracle.dbtools.raptor.liquibase.util.LbFileUtils.getLog()" is null
        at oracle.dbtools.raptor.scriptrunner.commands.liquibase.LbCommand.write_success(LbCommand.java:475)
        at oracle.dbtools.raptor.scriptrunner.commands.liquibase.LbCommand.handleEvent(LbCommand.java:382)
        at oracle.dbtools.raptor.newscriptrunner.CommandRegistry.fireListeners(CommandRegistry.java:454)
        at oracle.dbtools.raptor.newscriptrunner.ScriptRunner.lambda$run$0(ScriptRunner.java:241)
        at oracle.dbtools.raptor.newscriptrunner.ScriptRunnerContext.runWithStoredContext(ScriptRunnerContext.java:837)
```

</div>

</div>

## 7. Run LB Status before Prod Deployment To Avoid Surprises

To avoid any surprises, what would be run in Production, before proceeding with a real update, **always** run `LB STATUS`:

<div class="code panel pdl conf-macro output-block" hasbody="true" local-id="5d9694b9-e9dc-47c3-be8e-9a527248b241" macro-id="64ba303f-2811-4d34-896b-f5862b6376b8" macro-name="code" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` sql
conn -name proj_prod
lb status  -changelog-file releases/main.changelog.xml
```

</div>

</div>

This command shows what changesets would be run by the next **LB update**

It produces the following output:

<div class="code panel pdl conf-macro output-block" hasbody="true" local-id="772a6f80-0588-4dd7-8b7f-9b8d7c1a15f3" macro-id="c272cc14-c4ba-46e0-b84c-3175656fd035" macro-name="code" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` sql
SQL> lb status  -changelog-file releases/main.changelog.xml
--Starting Liquibase at 2025-11-21T16:38:05.487693200 using Java 17.0.13 (version 4.30.0 #0 built at 2025-04-01 10:24+0000)
4 changesets have not been applied to CLA_DEPLOYER@jdbc:oracle:thin:@//10.194.2.167:1521/pdb01.privsubnet2reg.vcnclaylacy01.oraclevcn.com
     dev-01/_custom/ams_config_dml.sql::1761249915279::SqlCl
     erp_fix_apexdev/cla_apex/package_specs/erp_emergency_event_util.sql::1763752587080::CLA_APEX
     erp_fix_apexdev/cla_apex/package_bodies/erp_emergency_event_util.sql::1763752586636::CLA_APEX
     releases/apex/f110/f110.xml::INSTALL_110::SQLCL-Generated


Operation completed successfully.
```

</div>

</div>

Make sure you recognize all changes ( and the most important - all APEX apps that are going to be deployed)

## 8. APEX Apps Manual Backup

For backfills and hotfixes, you sometimes need to back up the app in the destination environment. Here is a small helper script for that. It exports app X and imports it as 1000+X:

<div class="code panel pdl conf-macro output-block" hasbody="true" macro-id="159bb92b-a06e-49f3-9e74-941606204cd4" macro-name="code" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` sql
--- Backup APEX apps under app ID +1000

set define on
set verify off
set feedback on
---set echo on

cd .

accept p_app_id prompt 'Enter Application ID to backup: '

! mkdir "tmp/backup"

apex export -applicationid &p_app_id. -dir tmp/backup 

set define on
prompt 'Backup completed. File located at tmp/backup/f&p_app_id..sql'

begin
   apex_application_install.set_application_id(1000+to_number(&p_app_id.)); 
   APEX_APPLICATION_INSTALL.GENERATE_OFFSET;
 end;
/ 

set feedback off
set echo off

@tmp/backup/f&p_app_id..sql 
prompt 'Application &p_app_id. imported as 1&p_app_id.'
```

</div>

</div>

The script is located at `scripts/sql/deployment/backup_apps.sql`
